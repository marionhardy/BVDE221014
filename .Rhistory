gs_name,
gene_symbol
),
nPermSimple = 10000)
dotplot(gsea_results_GO, x = "NES", showCategory = 30)+ ggtitle("GSEA Gene Ontology LFC epithelial cells")
gsea_results_GO_t <- as_tibble(gsea_results_GO)
gsea_results_GO_t %>%
select(1:9) %>%
knitr::kable()
gsea_results_GOMF <- GSEA(
geneList = ordered_genes_fc,
pvalueCutoff = 0.05,
eps = 0,
seed = TRUE,
pAdjustMethod = "BH",
TERM2GENE = dplyr::select(
hsa_GOMF_sets,
gs_name,
gene_symbol
),
nPermSimple = 10000)
dotplot(gsea_results_GOMF, x = "NES", showCategory = 30)+ ggtitle("GSEA Gene Ontology LFC epithelial cells")
gsea_results_GOMF_t <- as_tibble(gsea_results_GOMF)
gsea_results_GOMF_t %>%
select(1:9) %>%
knitr::kable()
# Chunk 11
gsea_results_react <- GSEA(
geneList = ordered_genes_fc,
pvalueCutoff = 0.05,
eps = 0,
seed = TRUE,
pAdjustMethod = "BH",
TERM2GENE = dplyr::select(
hsa_reactome_sets,
gs_name,
gene_symbol
),
nPermSimple = 10000
)
dotplot(gsea_results_react, x = "NES", showCategory = 30)+ ggtitle("GSEA reactome LFC epithelial cells")
gsea_results_react_t <- as_tibble(gsea_results_react)
gsea_results_react_t %>%
select(1:9) %>%
knitr::kable()
gsea_results_wiki <- GSEA(
geneList = ordered_genes_fc,
pvalueCutoff = 0.05,
eps = 0,
seed = TRUE,
pAdjustMethod = "BH",
TERM2GENE = dplyr::select(
hsa_wiki_sets,
gs_name,
gene_symbol
),
nPermSimple = 10000
)
dotplot(gsea_results_wiki, x = "NES", showCategory = 30)+ ggtitle("GSEA Wikipathway LFC epithelial cells")
gsea_results_wiki_t <- as_tibble(gsea_results_wiki)
gsea_results_wiki_t %>%
select(1:9) %>%
knitr::kable()
# Chunk 12
sessionInfo()
# Chunk 1: setup
knitr::opts_chunk$set(message = FALSE, cache = TRUE, echo = FALSE, warning = F, cache.lazy = F)
knitr::opts_chunk$set(fig.width=10, fig.height=15)
library(tidyverse)
library(ggrepel)
library(clusterProfiler)
library(msigdbr)
# Chunk 2: Data loading
res_tbl <- read_csv("./data_output/res_tbl.csv")
diff <- read_csv("./data_output/sign_different.csv")
res_tbl1 <-  res_tbl %>% filter(!is.na(ENTREZID), padj<0.05)
# Chunk 3
res_tbl %>%
filter(!is.na(padj)) %>%
ggplot(aes(x = log2FoldChange, y = -log10(padj),
color = padj < 0.05 & abs(log2FoldChange) > 1,
label = ifelse(padj<0.05&log2FoldChange>=1|
padj<0.05&log2FoldChange<=-1,as.character(gene),''))) +
scale_colour_manual(values = c("gray", "firebrick3")) +
labs(col="Significantly expressed")+
geom_point(size = 0.5) +
geom_hline(yintercept = -log10(0.05)) +
geom_vline(xintercept = 1) +
geom_vline(xintercept = -1)+
geom_text_repel(max.overlaps = 30)+
labs(title = "H2O2 vs NT")+
theme_bw()
# Chunk 4
ordered_genes_fc <- res_tbl1$log2FoldChange
names(ordered_genes_fc) <- res_tbl1$gene
ordered_genes_fc <- sort(ordered_genes_fc, decreasing = T)
# Chunk 5
# MsigDb
hsa_GOBP_sets <- msigdbr(
species = "Homo sapiens",
category = "C5",
subcategory = "GO:BP") # for reactome collection
hsa_GOMF_sets <- msigdbr(
species = "Homo sapiens",
category = "C5",
subcategory = "GO:MF") # for reactome collection
hsa_reactome_sets <- msigdbr(
species = "Homo sapiens",
category = "C2",
subcategory = "CP:REACTOME") # for reactome collection
hsa_kegg_sets <- msigdbr(
species = "Homo sapiens",
category = "C2",
subcategory = "CP:KEGG") # for KEGG collection
hsa_wiki_sets <- msigdbr(
species = "Homo sapiens",
category = "C2",
subcategory = "CP:WIKIPATHWAYS") # for Wikipathways collection
set.seed(054057) # for reproducibility
# Chunk 6
# GO
gsea_results_GO <- GSEA(
geneList = ordered_genes_fc,
pvalueCutoff = 0.05,
eps = 0,
seed = TRUE,
pAdjustMethod = "BH",
TERM2GENE = dplyr::select(
hsa_GOBP_sets,
gs_name,
gene_symbol
),
nPermSimple = 10000)
dotplot(gsea_results_GO, x = "NES", showCategory = 30)+ ggtitle("GSEA Gene Ontology LFC epithelial cells")
gsea_results_GO_t <- as_tibble(gsea_results_GO)
gsea_results_GOMF_t %>%
select(1:9) %>%
knitr::kable()
gsea_results_GOMF <- GSEA(
geneList = ordered_genes_fc,
pvalueCutoff = 0.05,
eps = 0,
seed = TRUE,
pAdjustMethod = "BH",
TERM2GENE = dplyr::select(
hsa_GOMF_sets,
gs_name,
gene_symbol
),
nPermSimple = 10000)
dotplot(gsea_results_GOMF, x = "NES", showCategory = 30)+ ggtitle("GSEA Gene Ontology LFC epithelial cells")
gsea_GOMF_t = as_tibble(gsea_results_GOMF)
gsea_GOMF_t %>%
select(1:9) %>%
knitr::kable()
# Chunk 7: Epith Msigdb query
gsea_results_react <- GSEA(
geneList = ordered_genes_fc,
pvalueCutoff = 0.05,
eps = 0,
seed = TRUE,
pAdjustMethod = "BH",
TERM2GENE = dplyr::select(
hsa_reactome_sets,
gs_name,
gene_symbol
),
nPermSimple = 10000
)
dotplot(gsea_results_react, x = "NES", showCategory = 30)+ ggtitle("GSEA reactome LFC epithelial cells")
gsea_results_react_t <- as_tibble(gsea_results_react)
gsea_results_react_t %>%
select(1:9) %>%
knitr::kable()
gsea_results_wiki <- GSEA(
geneList = ordered_genes_fc,
pvalueCutoff = 0.05,
eps = 0,
seed = TRUE,
pAdjustMethod = "BH",
TERM2GENE = dplyr::select(
hsa_wiki_sets,
gs_name,
gene_symbol
),
nPermSimple = 10000
)
dotplot(gsea_results_wiki, x = "NES", showCategory = 30)+ ggtitle("GSEA Wikipathway LFC epithelial cells")
gsea_results_wiki_t <- as_tibble(gsea_results_wiki)
gsea_results_wiki_t %>%
select(1:9) %>%
knitr::kable()
# Chunk 8
res_tbl %>%
filter(!is.na(padj)) %>%
ggplot(aes(x = log2FoldChange, y = -log10(padj),
color = padj < 0.001 & abs(log2FoldChange) > 1,
label = ifelse(padj<0.001&log2FoldChange>=1|
padj<0.001&log2FoldChange<=-1,as.character(gene),''))) +
scale_colour_manual(values = c("gray", "firebrick3")) +
labs(col="Significantly expressed")+
geom_point(size = 0.5) +
geom_hline(yintercept = -log10(0.001)) +
geom_vline(xintercept = 1) +
geom_vline(xintercept = -1)+
geom_text_repel(max.overlaps = 30)+
labs(title = "H2O2 vs NT")+
theme_bw()
# Chunk 9
res_tbl1 = res_tbl1 %>% filter(padj <= 0.001)
ordered_genes_fc <- res_tbl1$log2FoldChange
names(ordered_genes_fc) <- res_tbl1$gene
ordered_genes_fc <- sort(ordered_genes_fc, decreasing = T)
# Chunk 10
# GO
gsea_results_GO <- GSEA(
geneList = ordered_genes_fc,
pvalueCutoff = 0.05,
eps = 0,
seed = TRUE,
pAdjustMethod = "BH",
TERM2GENE = dplyr::select(
hsa_GOBP_sets,
gs_name,
gene_symbol
),
nPermSimple = 10000)
dotplot(gsea_results_GO, x = "NES", showCategory = 30)+ ggtitle("GSEA Gene Ontology LFC epithelial cells")
gsea_results_GO_t <- as_tibble(gsea_results_GO)
gsea_results_GO_t %>%
select(1:9) %>%
knitr::kable()
gsea_results_GOMF <- GSEA(
geneList = ordered_genes_fc,
pvalueCutoff = 0.05,
eps = 0,
seed = TRUE,
pAdjustMethod = "BH",
TERM2GENE = dplyr::select(
hsa_GOMF_sets,
gs_name,
gene_symbol
),
nPermSimple = 10000)
dotplot(gsea_results_GOMF, x = "NES", showCategory = 30)+ ggtitle("GSEA Gene Ontology LFC epithelial cells")
gsea_results_GOMF_t <- as_tibble(gsea_results_GOMF)
gsea_results_GOMF_t %>%
select(1:9) %>%
knitr::kable()
# Chunk 11
gsea_results_react <- GSEA(
geneList = ordered_genes_fc,
pvalueCutoff = 0.05,
eps = 0,
seed = TRUE,
pAdjustMethod = "BH",
TERM2GENE = dplyr::select(
hsa_reactome_sets,
gs_name,
gene_symbol
),
nPermSimple = 10000
)
dotplot(gsea_results_react, x = "NES", showCategory = 30)+ ggtitle("GSEA reactome LFC epithelial cells")
gsea_results_react_t <- as_tibble(gsea_results_react)
gsea_results_react_t %>%
select(1:9) %>%
knitr::kable()
gsea_results_wiki <- GSEA(
geneList = ordered_genes_fc,
pvalueCutoff = 0.05,
eps = 0,
seed = TRUE,
pAdjustMethod = "BH",
TERM2GENE = dplyr::select(
hsa_wiki_sets,
gs_name,
gene_symbol
),
nPermSimple = 10000
)
dotplot(gsea_results_wiki, x = "NES", showCategory = 30)+ ggtitle("GSEA Wikipathway LFC epithelial cells")
gsea_results_wiki_t <- as_tibble(gsea_results_wiki)
gsea_results_wiki_t %>%
select(1:9) %>%
knitr::kable()
# Chunk 12
sessionInfo()
gsea_results_GOMF <- GSEA(
geneList = ordered_genes_fc,
pvalueCutoff = 0.05,
eps = 0,
seed = TRUE,
pAdjustMethod = "BH",
TERM2GENE = dplyr::select(
hsa_GOMF_sets,
gs_name,
gene_symbol
),
nPermSimple = 10000)
knitr::opts_chunk$set(message = FALSE, cache = TRUE, echo = FALSE, warning = F, cache.lazy = F)
knitr::opts_chunk$set(fig.width=10, fig.height=15)
library(tidyverse)
library(ggrepel)
library(clusterProfiler)
library(msigdbr)
gsea_GOMF_t %>%
select(1:9) %>%
knitr::kable()
unlink('AMR221014_report_cache', recursive = TRUE)
gsea_results_GOMF <- GSEA(
geneList = ordered_genes_fc,
pvalueCutoff = 0.05,
eps = 0,
seed = TRUE,
pAdjustMethod = "BH",
TERM2GENE = dplyr::select(
hsa_GOMF_sets,
gs_name,
gene_symbol
),
nPermSimple = 10000)
GO_antigen_pres = read.table("./data/GO0019882_terms.txt", sep = t)
GO_antigen_pres = read.table("./data/GO0019882_terms.txt", sep = t)
GO_antigen_pres = read.table("./data/GO0019882_terms.txt", sep = "t")
GO_antigen_pres = read.table("./data/GO0019882_terms.txt", sep = "")
GO_antigen_pres = read.table("./data/GO0019882_terms.txt", sep = "", col.names = T)
GO_antigen_pres = read.table("./data/GO0019882_terms.txt", sep = "", col.names = F)
GO_antigen_pres = read.table("./data/GO0019882_terms.txt", sep = "t", col.names = F)
GO_antigen_pres = read.table("./data/GO0019882_terms.txt", sep = "/", col.names = F)
View(GO_antigen_pres)
?read.table
GO_antigen_pres = read.table("./data/GO0019882_terms.txt", header = F)
GO_antigen_pres = read.table("./data/GO0019882_terms.txt", sep = "", col.names = F)
GO_antigen_pres = read.table("./data/GO0019882_terms.txt", sep = "")
GO_antigen_pres = read.table("./data/GO0019882_terms.txt", sep = "t")
GO_antigen_pres = read.table("./data/GO0019882_terms.txt", sep = "t")
read_csv(("./data/GO.csv"))
GO_antigen_pres = read_tsv("./data/GO0019882_terms.txt", col_names = F)
View(GO_antigen_pres)
table(GO_antigen_pres$X3)
table(GO_antigen_pres$X3)
GO_antigen_pres = read_tsv("./data/GO0019882.tsv", col_names = F)
View(GO_antigen_pres)
View(GO_antigen_pres)
target = res_tbl1 %>%
filter(gene%in%GO_antigen_pres$gene)
View(target)
res_tbl1$gene
GO_antigen_pres$gene
colnames(GO_antigen_pres) = c("gene","uniprot","description","X1","GO_term",
"relationship","source","taxon","X2","X3",
"X4","X5","X6","X7","X8")
target = res_tbl1 %>%
filter(gene%in%GO_antigen_pres$gene)
View(target)
res_tbl %>%
filter(!is.na(padj)) %>%
ggplot(aes(x = log2FoldChange, y = -log10(padj),
color = padj < 0.05 & abs(log2FoldChange) > 1,
label = ifelse(padj<0.05&log2FoldChange>=1|
padj<0.05&log2FoldChange<=-1,as.character(gene),''))) +
scale_colour_manual(values = c("gray", "firebrick3")) +
labs(col="Significantly expressed")+
geom_point(size = 0.5) +
geom_hline(yintercept = -log10(0.05)) +
geom_vline(xintercept = 1) +
geom_vline(xintercept = -1)+
geom_text_repel(max.overlaps = 30)+
labs(title = "H2O2 vs NT")+
theme_bw()+
geom_point(data=mitoc_pattern,
aes(x=log2FoldChange,y=-log10(padj)),
color='blue',
size=0.5)+
geom_text_repel(data = mitoc_pattern, size = 3, segment.color = "blue",
max.overlaps = 30, min.segment.length = 0, color = "blue",
box.padding = 0.5)+
theme(legend.title= element_blank())
res_tbl %>%
filter(!is.na(padj)) %>%
ggplot(aes(x = log2FoldChange, y = -log10(padj),
color = padj < 0.05 & abs(log2FoldChange) > 1,
label = ifelse(padj<0.05&log2FoldChange>=1|
padj<0.05&log2FoldChange<=-1,as.character(gene),''))) +
scale_colour_manual(values = c("gray", "firebrick3")) +
labs(col="Significantly expressed")+
geom_point(size = 0.5) +
geom_hline(yintercept = -log10(0.05)) +
geom_vline(xintercept = 1) +
geom_vline(xintercept = -1)+
geom_text_repel(max.overlaps = 30)+
labs(title = "H2O2 vs NT")+
theme_bw()+
geom_point(data=target,
aes(x=log2FoldChange,y=-log10(padj)),
color='blue',
size=0.5)+
geom_text_repel(data = target, size = 3, segment.color = "blue",
max.overlaps = 30, min.segment.length = 0, color = "blue",
box.padding = 0.5)+
theme(legend.title= element_blank())
res_tbl %>%
filter(!is.na(padj)) %>%
ggplot(aes(x = log2FoldChange, y = -log10(padj),
color = padj < 0.05 & abs(log2FoldChange) > 1,
label = ifelse(padj<0.05&log2FoldChange>=1|
padj<0.05&log2FoldChange<=-1,as.character(gene),''))) +
scale_colour_manual(values = c("gray", "firebrick3")) +
labs(col="Significantly expressed")+
geom_point(size = 0.5) +
geom_hline(yintercept = -log10(0.05)) +
geom_vline(xintercept = 1) +
geom_vline(xintercept = -1)+
labs(title = "H2O2 vs NT")+
theme_bw()+
geom_point(data=target,
aes(x=log2FoldChange,y=-log10(padj)),
color='blue',
size=0.5)+
geom_text_repel(data = target, size = 3, segment.color = "blue",
max.overlaps = 30, min.segment.length = 0, color = "blue",
box.padding = 0.5)+
theme(legend.title= element_blank())
res_tbl %>%
filter(!is.na(padj)) %>%
ggplot(aes(x = log2FoldChange, y = -log10(padj),
color = padj < 0.05 & abs(log2FoldChange) > 1,
label = ifelse(padj<0.05&log2FoldChange>=1|
padj<0.05&log2FoldChange<=-1,as.character(gene),''))) +
scale_colour_manual(values = c("gray", "firebrick3")) +
labs(col="Significantly expressed")+
geom_point(size = 0.5) +
geom_hline(yintercept = -log10(0.05)) +
geom_vline(xintercept = 1) +
geom_vline(xintercept = -1)+
labs(title = "H2O2 vs NT")+
theme_bw()+
geom_point(data=target,
aes(x=log2FoldChange,y=-log10(padj)),
color='blue',
size=0.5)+
geom_text_repel(data = target, size = 3, segment.color = "blue",
max.overlaps = 30, min.segment.length = 5, color = "blue",
box.padding = 0.5)+
theme(legend.title= element_blank())
res_tbl %>%
filter(!is.na(padj)) %>%
ggplot(aes(x = log2FoldChange, y = -log10(padj),
color = padj < 0.05 & abs(log2FoldChange) > 1,
label = ifelse(padj<0.05&log2FoldChange>=1|
padj<0.05&log2FoldChange<=-1,as.character(gene),''))) +
scale_colour_manual(values = c("gray", "firebrick3")) +
labs(col="Significantly expressed")+
geom_point(size = 0.5) +
geom_hline(yintercept = -log10(0.05)) +
geom_vline(xintercept = 1) +
geom_vline(xintercept = -1)+
labs(title = "H2O2 vs NT")+
theme_bw()+
geom_point(data=target,
aes(x=log2FoldChange,y=-log10(padj)),
color='blue',
size=0.5)+
geom_text_repel(data = target, size = 3, segment.color = "blue",
max.overlaps = 30, min.segment.length = 100, color = "blue",
box.padding = 0.5)+
theme(legend.title= element_blank())
res_tbl %>%
filter(!is.na(padj)) %>%
ggplot(aes(x = log2FoldChange, y = -log10(padj),
color = padj < 0.05 & abs(log2FoldChange) > 1,
label = ifelse(padj<0.05&log2FoldChange>=1|
padj<0.05&log2FoldChange<=-1,as.character(gene),''))) +
scale_colour_manual(values = c("gray", "firebrick3")) +
labs(col="Significantly expressed")+
geom_point(size = 0.5) +
geom_hline(yintercept = -log10(0.05)) +
geom_vline(xintercept = 1) +
geom_vline(xintercept = -1)+
labs(title = "H2O2 vs NT")+
theme_bw()+
geom_point(data=target,
aes(x=log2FoldChange,y=-log10(padj)),
color='blue',
size=0.5)+
geom_text_repel(data = target, size = 3, segment.color = "blue",
max.overlaps = 30, min.segment.length = 0, color = "blue",
box.padding = 0.5)+
theme(legend.title= element_blank())
res_tbl %>%
filter(!is.na(padj)) %>%
ggplot(aes(x = log2FoldChange, y = -log10(padj),
color = padj < 0.05 & abs(log2FoldChange) > 1,
label = ifelse(padj<0.05&log2FoldChange>=1|
padj<0.05&log2FoldChange<=-1,as.character(gene),''))) +
scale_colour_manual(values = c("gray", "firebrick3")) +
labs(col="Significantly expressed")+
geom_point(size = 0.5) +
geom_hline(yintercept = -log10(0.05)) +
geom_vline(xintercept = 1) +
geom_vline(xintercept = -1)+
labs(title = "H2O2 vs NT")+
theme_bw()+
geom_point(data=target,
aes(x=log2FoldChange,y=-log10(padj)),
color='blue',
size=0.5)+
geom_text_repel(data = target, size = 5, segment.color = "blue",
max.overlaps = 50, min.segment.length = 0, color = "blue",
box.padding = 0.5)+
theme(legend.title= element_blank())
